service:
  name: skpdi-dashboard-backend
  dockerfile: ./Dockerfile
  # Ограничиваем rebuild только изменениями, которые затрагивают серверный код.
  # Amvera поддерживает фильтрацию автосборок по путям: если изменились только
  # файлы, попадающие под ignore_paths, сборка и перезапуск сервиса не запускаются.
  # Это позволяет коммитить документацию фронтенда в docs/ без перезапуска backend.
  context: .
  ignore_paths:
    - "docs/**"
  ports:
    - 8000

  env:
    - name: DB_DSN
      value: postgresql://USER:PASSWORD@HOST:5432/DBNAME?sslmode=require
    # Разрешённые origin'ы для CORS (через запятую).
    # Например: https://dima.github.io,https://u4s.ru
    - name: ALLOWED_ORIGINS
      value: "*"
